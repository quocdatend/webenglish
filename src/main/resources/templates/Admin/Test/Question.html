<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Testing Page</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<div class="container-fluid">
    <!-- Page Heading -->
    <div class="container">
        <div class="row align-items-center">
            <div class="col">
                <h1 class="h3 mb-2 text-gray-800">Testing - Admin</h1>
            </div>
        </div>
    </div>
    <!-- DataTables Example -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">DataTables</h6>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>QuestionText</th>
                        <th>Answer</th>
                        <th>CorrectAnswer</th>
                        <th>Action</th>
                    </tr>
                    </thead>
                    <tfoot>
                    <tr>
                        <th>ID</th>
                        <th>QuestionText</th>
                        <th>Answer</th>
                        <th>CorrectAnswer</th>
                        <th>Action</th>
                    </tr>
                    </tfoot>
                    <tbody>
                    <tr th:each="item : ${questions}">
                        <td th:text="${item.questionId}"></td>
                        <td th:text="${item.questionText}"></td>
                        <td>
                            <input type="text" style="display: block; margin-bottom: 5px;" th:value="'A. ' + ${item.answerA}">
                            <input type="text" style="display: block; margin-bottom: 5px;" th:value="'B. ' + ${item.answerB}">
                            <input type="text" style="display: block; margin-bottom: 5px;" th:value="'C. ' + ${item.answerC}">
                            <input type="text" style="display: block; margin-bottom: 5px;" th:value="'D. ' + ${item.answerD}">
                        </td>
                        <td>
                            <select name="answers">
                                <option th:value="${item.correctAnswer}" th:text="'Đáp án ' + ${item.correctAnswer}"></option>
                            </select>
                        </td>
                        <td>
                            <form th:action="@{/admin/EditQuestion/{id}(id=${item.questionId})}" method="post">
                                <button type="submit"><i class="fas fa-edit"></i></button>
                            </form>
                            <form th:action="@{/admin/DeleteQuestion/{id}(id=${item.questionId})}" method="post">
                                <button type="submit" class="btn btn-danger"><i class="fas fa-trash-alt"></i></button>
                            </form>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <div class="col">
                    <div class="scroll-to-section">
                        <a th:href="@{/admin/AddQuestion/{id}(id=${idquestioncontent})}" class="btn btn-primary">ADD new Question</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a th:href="@{/admin/Question_content/{id}(id=${idexam})}">Back to List</a>
</div>

<!-- Form để thêm/sửa questions -->
<div class="container-fluid mt-4">
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Edit/Add Question</h6>
        </div>
        <div class="card-body">
            <form th:action="@{/admin/SaveQuestion}" method="post">
                <div class="form-group">
                    <label for="questionId">ID</label>
                    <input type="text" class="form-control" id="questionId" name="questionId" th:value="${questions.questionId}" readonly>
                </div>
                <div class="form-group">
                    <label for="questionText">Question Text</label>
                    <textarea class="form-control" id="questionText" name="questionText" th:text="${questions.questionText}" required></textarea>
                </div>
                <div class="form-group">
                    <label for="answerA">Answer A</label>
                    <input type="text" class="form-control" id="answerA" name="answerA" th:value="${questions.answerA}" required>
                </div>
                <div class="form-group">
                    <label for="answerB">Answer B</label>
                    <input type="text" class="form-control" id="answerB" name="answerB" th:value="${questions.answerB}" required>
                </div>
                <div class="form-group">
                    <label for="answerC">Answer C</label>
                    <input type="text" class="form-control" id="answerC" name="answerC" th:value="${questions.answerC}" required>
                </div>
                <div class="form-group">
                    <label for="answerD">Answer D</label>
                    <input type="text" class="form-control" id="answerD" name="answerD" th:value="${questions.answerD}" required>
                </div>
                <div class="form-group">
                    <label for="correctAnswer">Correct Answer</label>
                    <select class="form-control" id="correctAnswer" name="correctAnswer" required>
                        <option value="A" th:selected="${questions.correctAnswer == 'A'}">A</option>
                        <option value="B" th:selected="${questions.correctAnswer == 'B'}">B</option>
                        <option value="C" th:selected="${questions.correctAnswer == 'C'}">C</option>
                        <option value="D" th:selected="${questions.correctAnswer == 'D'}">D</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll('.btn-danger').forEach(function (btn) {
            btn.addEventListener('click', function (e) {
                if (!confirm("Are you sure you want to delete this exam?")) {
                    e.preventDefault();
                }
            });
        });
    });
</script>
</body>
</html>